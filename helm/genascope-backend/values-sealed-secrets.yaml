# Configuration for Sealed Secrets
# This file shows how to configure the chart to use Sealed Secrets instead of external secrets

# Enable sealed secrets
sealedSecrets:
  enabled: true
  # These are encrypted values - replace with your actual encrypted secrets
  # Generate these using: kubeseal --raw --from-file=mykey --scope=strict --namespace=<namespace>
  encryptedData:
    postgres-password: "AgBy3i4OJSWK+PiTySYZZA9rO6HcOcw=="  # Replace with encrypted value
    secret-key: "AgAKV7ha9q8SZvwKn3YQKf9nO3ScMpZ=="           # Replace with encrypted value
    openai-api-key: "AgBm2kL8vQ5RJfxNp1WaEr8dP2HbNsX=="       # Replace with encrypted value
    lab-api-key: "AgCr7jM9zT4KLgwOq6VcTy3nR5GdQpY=="         # Replace with encrypted value (optional)
    smtp-password: "AgDx8nP6yS2MLjxRs9ZfGh4mT7KlWqZ=="       # Replace with encrypted value (optional)

# Application configuration (same as other environments)
app:
  environment: "development"
  frontendUrl: "http://localhost:3000"
  
  database:
    host: "postgresql"
    port: 5432
    name: "genascope"
    user: "genascope"
    # When using sealed secrets, these are ignored
    passwordSecret:
      name: "pgvector-secret"
      key: "postgres-password"
  
  apis:
    openai:
      # When using sealed secrets, these are ignored
      secretName: "openai-secret"
      secretKey: "api-key"
    
    lab:
      url: ""  # Set if using lab integration
      # When using sealed secrets, these are ignored
      secretName: "lab-secret"
      secretKey: "api-key"
  
  cors:
    origins:
      - "http://localhost:3000"
      - "https://genascope.dev"
  
  smtp:
    host: ""      # Set if using SMTP
    port: "587"   # Set if using SMTP
    user: ""      # Set if using SMTP
    # When using sealed secrets, these are ignored
    secretName: "smtp-secret"
    secretKey: "password"

# Image configuration
image:
  repository: "ghcr.io/your-org/genascope-backend"
  tag: "latest"
  pullPolicy: IfNotPresent

# Service configuration
service:
  type: ClusterIP
  port: 80
  targetPort: 8000

# Ingress configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
  hosts:
    - host: api-dev.genascope.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

# Resource limits
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 250m
    memory: 256Mi

# Health checks
healthChecks:
  enabled: true
  livenessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5

# Autoscaling
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80
