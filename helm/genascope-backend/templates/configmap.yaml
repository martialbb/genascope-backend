apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "genascope-backend.fullname" . }}-config
  labels:
    {{- include "genascope-backend.labels" . | nindent 4 }}
data:
  # Application configuration
  ENVIRONMENT: {{ .Values.app.environment | quote }}
  FRONTEND_URL: {{ .Values.app.frontendUrl | quote }}
  CORS_ORIGINS: {{ .Values.app.cors.origins | toJson | quote }}
  
  # Database configuration (non-sensitive)
  {{- if not .Values.app.database.external }}
  DATABASE_HOST: {{ .Values.app.database.host | quote }}
  DATABASE_PORT: {{ .Values.app.database.port | quote }}
  DATABASE_NAME: {{ .Values.app.database.name | quote }}
  DATABASE_USER: {{ .Values.app.database.user | quote }}
  {{- end }}
  
  # Redis configuration
  {{- if .Values.app.redis.enabled }}
  REDIS_HOST: {{ .Values.app.redis.host | quote }}
  REDIS_PORT: {{ .Values.app.redis.port | quote }}
  {{- end }}
  
  # SMTP configuration (non-sensitive)
  {{- if and .Values.app.smtp .Values.app.smtp.host }}
  SMTP_HOST: {{ .Values.app.smtp.host | quote }}
  SMTP_PORT: {{ .Values.app.smtp.port | quote }}
  SMTP_USER: {{ .Values.app.smtp.user | quote }}
  {{- end }}
  
  # API URLs
  {{- if false }}
  {{- /* Lab API URL not configured for this deployment */ -}}
  LAB_API_URL: {{ .Values.app.apis.lab.url | quote }}
  {{- end }}
